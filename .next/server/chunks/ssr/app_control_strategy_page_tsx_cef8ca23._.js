module.exports=[13520,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(96313),e=a.i(3130),f=a.i(40695),g=a.i(54161),h=a.i(5522),i=a.i(17171),j=a.i(80281),k=a.i(46893),l=a.i(65733),m=a.i(87682),n=a.i(88237),o=a.i(5094),p=a.i(15618),q=a.i(3314),r=a.i(66384),s=a.i(4416),t=a.i(73570),u=a.i(24569),v=a.i(81560),w=a.i(5151),x=a.i(17755),y=a.i(70106);let z=(0,y.default)("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]),A=(0,y.default)("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var B=a.i(65385);let C=(0,y.default)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var D=a.i(76504);let E=[{id:"STR001",name:"费用刚性控制",type:"hard",scope:"全公司",subjects:["办公费用","差旅费用","业务招待费"],threshold:100,action:"超预算禁止提交",enabled:!0,priority:1,description:"当费用预算使用率达到100%时，禁止提交新的费用申请",createdAt:"2025-01-01",updatedAt:"2025-12-01"},{id:"STR002",name:"人工成本柔性控制",type:"soft",scope:"研发部, 市场部",subjects:["人工成本"],threshold:100,action:"超预算需额外审批",enabled:!0,priority:2,description:"当人工成本超预算时，允许提交但需要更高级别的审批",createdAt:"2025-01-01",updatedAt:"2025-11-15"},{id:"STR003",name:"预算预警提醒",type:"warning",scope:"全公司",subjects:["所有科目"],threshold:80,action:"发送预警通知",enabled:!0,priority:3,description:"当预算使用率达到80%时，向相关负责人发送预警通知",createdAt:"2025-01-01",updatedAt:"2025-10-20"},{id:"STR004",name:"项目预算控制",type:"hard",scope:"项目类预算",subjects:["项目费用","研发投入"],threshold:100,action:"超预算禁止支付",enabled:!1,priority:4,description:"项目预算用完后禁止继续支付，需要进行预算追加",createdAt:"2025-03-01",updatedAt:"2025-09-10"}],F=[{time:"2025-12-03 14:30",user:"张财务",action:"修改",strategy:"费用刚性控制",detail:"阈值从95%调整为100%"},{time:"2025-12-02 09:15",user:"李经理",action:"启用",strategy:"人工成本柔性控制",detail:"启用策略"},{time:"2025-12-01 16:45",user:"王总监",action:"新建",strategy:"预算预警提醒",detail:"创建新策略"},{time:"2025-11-28 11:00",user:"张财务",action:"禁用",strategy:"项目预算控制",detail:"临时禁用策略"}];function G(){let[a,y]=(0,c.useState)(E),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)({name:"",type:"hard",scope:"",subjects:"",threshold:100,action:"",description:"",priority:1}),S=a=>{y(b=>b.map(b=>b.id===a?{...b,enabled:!b.enabled}:b))},T=a.filter(a=>"hard"===a.type&&a.enabled).length,U=a.filter(a=>"soft"===a.type&&a.enabled).length,V=a.filter(a=>"warning"===a.type&&a.enabled).length;return(0,b.jsx)(d.MainLayout,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"控制策略"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"配置预算的刚性控制、柔性控制和预警规则"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>L(!0),children:[(0,b.jsx)(C,{className:"w-4 h-4 mr-2"}),"变更历史"]}),(0,b.jsxs)(f.Button,{className:"bg-primary hover:bg-primary/90",onClick:()=>{N(null),R({name:"",type:"hard",scope:"",subjects:"",threshold:100,action:"",description:"",priority:a.length+1}),H(!0)},children:[(0,b.jsx)(p.Plus,{className:"w-4 h-4 mr-2"}),"新建策略"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"p-4 flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:(0,b.jsx)(B.Settings2,{className:"w-6 h-6 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"策略总数"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:a.length})]})]})}),(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"p-4 flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-destructive/10 flex items-center justify-center",children:(0,b.jsx)(q.Shield,{className:"w-6 h-6 text-destructive"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"刚性控制"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:T})]})]})}),(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"p-4 flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-warning/10 flex items-center justify-center",children:(0,b.jsx)(s.ShieldCheck,{className:"w-6 h-6 text-warning"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"柔性控制"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:U})]})]})}),(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"p-4 flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-success/10 flex items-center justify-center",children:(0,b.jsx)(t.AlertTriangle,{className:"w-6 h-6 text-success"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"预警规则"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:V})]})]})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-3",children:(0,b.jsx)(e.CardTitle,{className:"text-base font-medium",children:"策略列表"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{className:"w-12",children:"状态"}),(0,b.jsx)(n.TableHead,{children:"策略名称"}),(0,b.jsx)(n.TableHead,{children:"控制类型"}),(0,b.jsx)(n.TableHead,{children:"适用范围"}),(0,b.jsx)(n.TableHead,{children:"控制科目"}),(0,b.jsx)(n.TableHead,{className:"text-center",children:"阈值"}),(0,b.jsx)(n.TableHead,{children:"控制动作"}),(0,b.jsx)(n.TableHead,{className:"text-center",children:"优先级"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"操作"})]})}),(0,b.jsx)(n.TableBody,{children:a.map(c=>(0,b.jsxs)(n.TableRow,{className:c.enabled?"":"opacity-50",children:[(0,b.jsx)(n.TableCell,{children:(0,b.jsx)(j.Switch,{checked:c.enabled,onCheckedChange:()=>S(c.id)})}),(0,b.jsx)(n.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(a=>{switch(a){case"hard":default:return(0,b.jsx)(q.Shield,{className:"w-4 h-4"});case"soft":return(0,b.jsx)(s.ShieldCheck,{className:"w-4 h-4"});case"warning":return(0,b.jsx)(r.ShieldAlert,{className:"w-4 h-4"})}})(c.type),(0,b.jsx)("span",{className:"font-medium",children:c.name})]})}),(0,b.jsx)(n.TableCell,{children:(a=>{switch(a){case"hard":return(0,b.jsx)(g.Badge,{className:"bg-destructive/20 text-destructive",children:"刚性控制"});case"soft":return(0,b.jsx)(g.Badge,{className:"bg-warning/20 text-warning",children:"柔性控制"});case"warning":return(0,b.jsx)(g.Badge,{className:"bg-primary/20 text-primary",children:"预警提醒"});default:return(0,b.jsx)(g.Badge,{children:"未知"})}})(c.type)}),(0,b.jsx)(n.TableCell,{children:c.scope}),(0,b.jsx)(n.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[c.subjects.slice(0,2).map((a,c)=>(0,b.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:a},c)),c.subjects.length>2&&(0,b.jsxs)(g.Badge,{variant:"outline",className:"text-xs",children:["+",c.subjects.length-2]})]})}),(0,b.jsxs)(n.TableCell,{className:"text-center font-mono",children:[c.threshold,"%"]}),(0,b.jsx)(n.TableCell,{className:"text-sm text-muted-foreground",children:c.action}),(0,b.jsx)(n.TableCell,{className:"text-center",children:(0,b.jsx)(g.Badge,{variant:"outline",children:c.priority})}),(0,b.jsx)(n.TableCell,{className:"text-right",children:(0,b.jsxs)(D.DropdownMenu,{children:[(0,b.jsx)(D.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(x.MoreHorizontal,{className:"w-4 h-4"})})}),(0,b.jsxs)(D.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(D.DropdownMenuItem,{onClick:()=>{N(c),R({name:c.name,type:c.type,scope:c.scope,subjects:c.subjects.join(", "),threshold:c.threshold,action:c.action,description:c.description,priority:c.priority}),H(!0)},children:[(0,b.jsx)(u.Edit,{className:"w-4 h-4 mr-2"}),"编辑"]}),(0,b.jsxs)(D.DropdownMenuItem,{onClick:()=>{let b,d;return b=new Date().toISOString().split("T")[0],d={...c,id:`STR${String(a.length+1).padStart(3,"0")}`,name:`${c.name} (副本)`,createdAt:b,updatedAt:b},void y(a=>[...a,d])},children:[(0,b.jsx)(w.Copy,{className:"w-4 h-4 mr-2"}),"复制"]}),(0,b.jsx)(D.DropdownMenuItem,{onClick:()=>S(c.id),children:c.enabled?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A,{className:"w-4 h-4 mr-2"}),"禁用"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(z,{className:"w-4 h-4 mr-2"}),"启用"]})}),(0,b.jsx)(D.DropdownMenuSeparator,{}),(0,b.jsxs)(D.DropdownMenuItem,{className:"text-destructive",onClick:()=>{P(c.id),J(!0)},children:[(0,b.jsx)(v.Trash2,{className:"w-4 h-4 mr-2"}),"删除"]})]})]})})]},c.id))})]})})]}),(0,b.jsx)(l.Dialog,{open:G,onOpenChange:H,children:(0,b.jsxs)(l.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(l.DialogHeader,{children:(0,b.jsx)(l.DialogTitle,{children:M?"编辑控制策略":"新建控制策略"})}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"策略名称"}),(0,b.jsx)(h.Input,{value:Q.name,onChange:a=>R(b=>({...b,name:a.target.value})),placeholder:"输入策略名称"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"控制类型"}),(0,b.jsxs)(m.Select,{value:Q.type,onValueChange:a=>R(b=>({...b,type:a})),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"hard",children:"刚性控制 - 超预算禁止操作"}),(0,b.jsx)(m.SelectItem,{value:"soft",children:"柔性控制 - 超预算需额外审批"}),(0,b.jsx)(m.SelectItem,{value:"warning",children:"预警提醒 - 达到阈值发送通知"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"适用范围"}),(0,b.jsx)(h.Input,{value:Q.scope,onChange:a=>R(b=>({...b,scope:a.target.value})),placeholder:"如：全公司、研发部"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"控制阈值 (%)"}),(0,b.jsx)(h.Input,{type:"number",value:Q.threshold,onChange:a=>R(b=>({...b,threshold:Number(a.target.value)}))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"控制科目（多个用逗号分隔）"}),(0,b.jsx)(h.Input,{value:Q.subjects,onChange:a=>R(b=>({...b,subjects:a.target.value})),placeholder:"如：办公费用, 差旅费用, 业务招待费"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"控制动作"}),(0,b.jsx)(h.Input,{value:Q.action,onChange:a=>R(b=>({...b,action:a.target.value})),placeholder:"如：超预算禁止提交"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"策略说明"}),(0,b.jsx)(k.Textarea,{value:Q.description,onChange:a=>R(b=>({...b,description:a.target.value})),placeholder:"详细描述该控制策略的作用",rows:3})]})]}),(0,b.jsxs)(l.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>H(!1),children:"取消"}),(0,b.jsx)(f.Button,{className:"bg-primary hover:bg-primary/90",onClick:()=>{let b=new Date().toISOString().split("T")[0];if(M)y(a=>a.map(a=>a.id===M.id?{...a,...Q,subjects:Q.subjects.split(",").map(a=>a.trim()),updatedAt:b}:a));else{let c={id:`STR${String(a.length+1).padStart(3,"0")}`,name:Q.name,type:Q.type,scope:Q.scope,subjects:Q.subjects.split(",").map(a=>a.trim()),threshold:Q.threshold,action:Q.action,description:Q.description,priority:Q.priority,enabled:!0,createdAt:b,updatedAt:b};y(a=>[...a,c])}H(!1)},children:M?"保存修改":"创建策略"})]})]})}),(0,b.jsx)(o.AlertDialog,{open:I,onOpenChange:J,children:(0,b.jsxs)(o.AlertDialogContent,{children:[(0,b.jsxs)(o.AlertDialogHeader,{children:[(0,b.jsx)(o.AlertDialogTitle,{children:"确认删除"}),(0,b.jsx)(o.AlertDialogDescription,{children:"确定要删除此控制策略吗？删除后将无法恢复，且相关的预算控制规则将失效。"})]}),(0,b.jsxs)(o.AlertDialogFooter,{children:[(0,b.jsx)(o.AlertDialogCancel,{children:"取消"}),(0,b.jsx)(o.AlertDialogAction,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>{O&&(y(a=>a.filter(a=>a.id!==O)),J(!1),P(null))},children:"确认删除"})]})]})}),(0,b.jsx)(l.Dialog,{open:K,onOpenChange:L,children:(0,b.jsxs)(l.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(l.DialogHeader,{children:(0,b.jsx)(l.DialogTitle,{children:"变更历史"})}),(0,b.jsx)("div",{className:"py-4",children:(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:"时间"}),(0,b.jsx)(n.TableHead,{children:"操作人"}),(0,b.jsx)(n.TableHead,{children:"操作类型"}),(0,b.jsx)(n.TableHead,{children:"策略名称"}),(0,b.jsx)(n.TableHead,{children:"变更内容"})]})}),(0,b.jsx)(n.TableBody,{children:F.map((a,c)=>(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableCell,{className:"text-muted-foreground",children:a.time}),(0,b.jsx)(n.TableCell,{children:a.user}),(0,b.jsx)(n.TableCell,{children:(0,b.jsx)(g.Badge,{variant:"outline",children:a.action})}),(0,b.jsx)(n.TableCell,{className:"font-medium",children:a.strategy}),(0,b.jsx)(n.TableCell,{className:"text-sm text-muted-foreground",children:a.detail})]},c))})]})})]})})]})})}a.s(["default",()=>G],13520)}];

//# sourceMappingURL=app_control_strategy_page_tsx_cef8ca23._.js.map